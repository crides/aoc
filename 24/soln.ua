# vim: set guifont=Uiua386\:h24:
# Experimental!

â”Œâ”€â•´Dâ‚
  P â† Â°âŠŸâ‰âŠœ(âŠœâ‹•âŠ¸â‰ @\s)âŠ¸â‰ @\n
  A â† /+âŒµ-âˆ©â†P
  B â† /+â‰¡(Ã—âŸœ(â§»âŠšâŒ•))âŠ™Â¤P
â””â”€â•´

â”Œâ”€â•´Dâ‚‚
  P    â† âŠœ(â–¡âŠœâ‹•âŠ¸â‰ @\s)âŠ¸â‰ @\n
  Safe â† âˆ¨âˆ©(/Ã—Ã—âŠƒâ‰¤â‚ƒâ‰¥â‚)âŸœÂ¯â‰¡/-â§ˆâˆ˜2
  A    â† â§»âŠšâ‰¡(SafeÂ°â–¡)P
  B    â† â§»âŠšâ‰¡(/âˆ¨â‰¡(Safeâœâ†»â†˜â‚)âŠ™Â¤Â°âŠÂ°â–¡)P
â””â”€â•´

â”Œâ”€â•´Dâ‚ƒ
  A â† /+â‰¡(â—‡Ã—âˆ©â‹•Â°âŠŸâ†˜1)regex$ mul\((\d+),(\d+)\)
  B â† Aâ–½âŠ¸(â¬š1\(â¨¬(âŠ™â—Œ|â‹…âˆ˜)Â±,)+âŠ™Ã—â‚‚âˆ©âŒ•"do()","don't()")
â””â”€â•´

â”Œâ”€â•´Dâ‚„
  Search â† /+â‰¡(+âˆ©(/+âŒ•)â‡Œ,,"XMAS")
  Diag   â† â‰¡â†»Â¯Â°âŠâ‰¡âŠ‚âŸœ(Â¤â–½:@\s-1â§»)
  A      â† /+[âŠƒ(Searchâ‰Diag|Searchâ‰âœâ‡ŒDiag|Search|Searchâ‰)]âŠœâˆ˜âŠ¸â‰ @\n
  B â† (
    âŠƒ(Diag|âœâ‡ŒDiag)âŠœâˆ˜âŠ¸â‰ @\n
    âˆ©(âœâ‰(âˆ¨âˆ©(â†»Â¯1âŒ•)â‡Œ,,"MAS"))
    /+â™­Ã—âŠ“(â‰¡â†»â‚‚â‰¡â†»Â°âŠ|âœâ‡Œ(â‰¡â†»Â°âŠ)) # â†»2 is.. probably due to the â‡Œ, but is added by experiment
  )
â””â”€â•´

â”Œâ”€â•´Dâ‚…
  P â† âŠ“(âŠœ(âŠœâ‹•âŠ¸â‰ @|)âŠ¸â‰ @\n|âŠœ(â–¡âŠœâ‹•âŠ¸â‰ @,)âŠ¸â‰ @\n)Â°â–¡â‚‚âŠœâ–¡âŠ¸(Â¬â¦·)"\n\n"
  A â† /+â‰¡â—‡(Ã—âŠƒ(/Ã—â‰¡/>â–½âŠ¸(/Ã—â‰Â±)+1â¬šÂ¯1âŠ—|âŠ¡âŠ¸(âŒŠÃ·2â§»)â—Œ))Â¤P
  B â† /+â‰¡â—‡(
    /Ã—â‰¡/>âˆ©â–½â—¡(,âŸœ(/Ã—â‰Â±)+1â¬šÂ¯1âŠ—)
    â¨¬(âŠ¡âŠ¸(âŒŠÃ·2â§»)âŠâŠ¸(â/+âŠ=)âŠ£â‰|â‹…0)
  )Â¤P
â””â”€â•´

â”Œâ”€â•´Dâ‚†
  P â† âŠƒ(âŠ¢âŠšâŒ•@^|=@#)âŠœâˆ˜âŠ¸â‰ @\n
  # looped been ? dir pos map
  Exp â† â‹…âŠ™â‹…â‹…âŠ™â—Œâ¢(|6.6
    â—¡(âŠƒâŠ¡âˆ˜+âŠ™âŠ™â‹…âˆ˜âŠ™âŠ™)â—Œâ—Œ # nextloc next dir pos been map ? cond looped dir pos been map
    â¨¬(:âŠ™âŠ™â—Œ|â‹…âœ(â„‚Â°âŠŸ)(Ã—i))
    â—¡(âŠ¸(Â¬âˆ¨)âŠƒ(âˆ¨âˆ©/âˆ¨âŠƒ(<0|â‰¤)âŠƒ(+âŠ™âˆ˜|â–³â‹…â‹…â‹…âˆ˜)|â¬š0âŠ¢âˆŠ:Â¤âŠŸ))
    âŠ™âŠ™âŠƒ(âŠ™âˆ˜|âŠ‚:Â¤âŠŸ)
  ).1 1âŠ™âŠ™(Â°â–³0_2_2)
  A â† +1/â†¥âŠ›â†˜0_1Â°0ExpÂ¯1_0P
  B â† (
    â—´âŠƒ(â™­â‚‚â†˜1_1Â°0ExpÂ¯1_0|âˆ©Â¤)P
    â§»â—´â–½âˆ©â‰¡Â°â–¡Â°âŠŸâ‰waitâ‰¡pool(âˆ©â–¡âŸœ(âŠ™â—ŒExpÂ¯1_0âŠ™(âœâŠ¡â‹…1):))
  )
  # A â† â‹…â‹…âŠ“(/+â™­)â—Œâ¢(|4.4
  #   â—¡(âŠƒâŠ¡âˆ˜+âŠ™âŠ™â‹…âˆ˜) # nextloc next dir pos been map ? dir pos been map
  #   âŠ™(âŸœâœâŠ¡â‹…1)â¨¬(:âŠ™âŠ™â—Œ|â‹…âœ(â„‚Â°âŠŸ)(Ã—i))
  # )â—¡(|3
  #   Â¬âˆ¨âˆ©/âˆ¨âŠƒ(<0|â‰¤)âŠƒ(+âŠ™âˆ˜|â–³â‹…â‹…âˆ˜)
  # )Â¯1_0âŠ™âŠ¸(âˆµâ‹…0)P
  # Expâ€¼ â† |4 â‹…â‹…âŠ™â—Œâ¢(
  #   # search mul
  #   â—¡(âŠƒâŠ¡âˆ˜+âŠ™âŠ™â‹…âˆ˜) # nextloc next dir pos been map ? dir pos been map
  #   âŠƒ(âŠ™âˆ˜|âŠ‚:Â¤âŠŸ)â¨¬(
  #     :âŠ™âŠ™â—Œ
  #   | âŸœ+â‹…âœ(â„‚Â°âŠŸ)(Ã—^1)
  #     â¥(âŠƒ(â‹…âŠ™âˆ˜|âŠ‚âŠ™â‹…â‹…âˆ˜)â—¡(Expâ€¼(0)(i)?â‚‚âŠ™âŠ™â‹…âˆ˜âŠƒ(âŠ™âˆ˜|Â¤âŠŸ)Â¯))^0
  #   )
  # )â—¡(
  #   Â¬âˆ¨âˆ©/âˆ¨âŠƒ(<0|â‰¤)âŠƒ(+âŠ™âˆ˜|â–³â‹…â‹…â‹…âˆ˜)
  # )
  # B â† (
  #   ?âŠ‚âŠƒ(âœ(â†™âˆ_1)Â¯Expâ€¼(0)(i)1_0âŠ™[]|Expâ€¼(1)(Â¯i)âŠƒ(âŠ™âˆ˜|Â¤âŠŸ)Â¯1_0)P
  #   â§»â—´â–½â‰¡((Ã—âŠ“(=iÃ·âˆ©(â„‚Â°âŠŸ)|âŠ¸â‰)âŠ™:âˆ©Â°âŠŸÂ°âŠŸ))âŠâ§…<2Â°âŠ
  # )
â””â”€â•´

â”Œâ”€â•´Dâ‚‡
  P  â† âŠœ(âŠ“â‹•(â–¡âŠœâ‹•âŠ¸â‰ @\s)Â°$"_: _")âŠ¸â‰ @\n
  S! â† /+waitâ‰¡pool(Ã—âŠ¸âˆŠâ—‡/^0):P
  A  â† S!(âŠ‚âŠƒ+Ã—)
  B  â† S!(âŠ‚âŠ‚âŠƒ(+|Ã—|+âŠ¸(Ã—âŠ™âœâ‚™â‚â‚€(+1âŒŠ))))
â””â”€â•´

â”Œâ”€â•´Dâ‚ˆ
  P â† âŠ›âŠƒ(/â—‡âŠ‚â‰¡Â°â—‡Â°â–½|âŠš|Â¤â–³)âŠ¸(â‰ @.)âŠœâˆ˜âŠ¸â‰ @\n
  A â† â§»â—´â–½:âŸœ(â‰¡/Ã—Ã—âŠƒâ‰¥â‚€>)/â—‡âŠ‚âŠ•(â–¡â‰¡(-âŠ™Ã—â‚‚Â°âŠŸ)â§…(Â¬â‰)2)P
  B â† (
    /â—‡âŠ‚âŠ•(â–¡/â—‡âŠ‚â‰¡(â–¡-Ã—â‡¡48âˆ©Â¤â¤š-Â°âŠŸ)â§…(Â¬â‰)2)P
    â§»â—´â–½:âŸœ(â‰¡/Ã—Ã—âŠƒâ‰¥â‚€>)
  )
â””â”€â•´

â”Œâ”€â•´Dâ‚‰
  # Show â† &pâŠ:".0123456789"+1â–½:Â°âŠŸâ‰
  P â† Â°âŠŸâ‰-@0â†¯âˆ_2âŠ‚:@0â–½âŠ¸â‰ @\n
  P â† ?â–½âˆµâ‹•:âŠ:-1â‡¡+1âŠ¸/â†¥âœâ–½\+.Â¬â—¿2Â°âŠâ–½âŠ¸â‰ @\n
  A â† (
    /â—‡âŠ‚â™­â‰:âŠ™âŠŸâŠ“(âŠƒ(/+|âšâ–½:Â°âŠ)|âšâ–½:Â¯1)P
    âŠ™â—Œâ¢(â–½âŠ¸(âœâ‡Œ\â†¥â‰ Â¯1)âœâŠâ—ŒâŠ™(âŠƒâ†˜â†™Â¯1)âŠ¸(âŠ¢âŠšâŒ•Â¯1))(â‰ â§»)
    /+Ã—Â°âŠ
  )
  A â† /+Ã—Â°âŠâ¢(â–½âœâ‡Œ\â†¥âŠ¸â‰ Â¯1âœâŠ¡â—ŒâŠ¸âŠ—Â¯1:âœâ‡ŒÂ°âŠ‚|/â†¥=Â¯1)P
  B â† (
    â–½âŠ¸(â‰ 0âŠ£â‰)â™­â‚‚â¤¸1âŠŸâŠ“(â‰âŠŸÂ°âŠ|â‰âŠ‚Â¯1Â¤)P
    âˆ§(âŠƒ(âŠ£âŠâŠ™â‹…âˆ˜|âŠ™âŠ™âˆ˜)âŠƒ(âŠ¢âŠš=âŠ™(âŠ¢â‰)|âŠ™âˆ˜)  # file-size file-ind file-id fs ? file-id fs
      âŠƒ(â¬šÂ¯1âŠ¢âŠšÃ—âŠ“=â‚‹â‚â‰¤Â°âŠŸâ‰:âŠ™â‹…â‹…âˆ˜|âŠ™âŠ™âŠ™âˆ˜) # space-ind file-size file-ind file-id fs ? file-size file-ind file-id fs
      âŠƒ(âŠ™â‹…âŠ™â‹…âˆ˜|â‹…âŠ™â‹…âˆ˜)               # space-ind file-ind fs file-size file-id
      â¨¬((âŠ™(âœ(âŠ¢âŠ)â‹…Â¯1)              # space-ind fs space-size file-size file-id ? space-ind file-ind fs space-size file-size file-id
         (âœâŠ(?âŠŸâŠ™(âŠŸÂ¯1)âŠŸ?:âŠ™:âŸœ-:?âŠ£)) # fs ? space-ind fs file-size file-id
        )
      | â‹…â‹…âŠ™â‹…â—Œ
      )âˆ¨â—¡âŠƒ(<|=Â¯1)
      â‰âŠŸ:Â°â–½â–½:Â°âŠŸâ‰
    )âŠ¸(â‡Œ+1â‡¡/â†¥âŠ¢â‰)
    /+â–½â‰ Â¯1â¤™Ã—Â°âŠâ–½:Â°âŠŸâ‰
  )
  B â† (
    /+Ã—Â°âŠâ†¥0 âˆ§(
      âŠ™,âˆ©â–½,Â¯1â§»âŠšâ—¡=
      âˆ©âŠšâŠ“âŒ•â—¡âŒ•
      â£(Â°1â¤š>âˆ©âŠ¢
        âœâŠ™â†˜(âŠ‚âŠ™â†˜:âŠ¸â§»):âŠ™âŸœ(âœâ–½âˆµâ‹…Â¯1âŠ¸â¦·)
      )â‹…â‹…â—Œ
    ) â‡Œâ‡¡-1â§»âŠ¸â—´P
  )
â””â”€â•´

â”Œâ”€â•´Dâ‚â‚€
  Neis â† [âˆ©Â¯,,â‡Œ.â‡¡2]
  S! â† /+â‰¡(
    â§»^0âŠ™â—Œpath(
      â–½=âŠƒ(+1âŠ¡|â¤šâ‰¡â¬šÂ¯1âŠ¡+Neisâˆ©Â¤)
    | =9âŠ¡
    )
  )âŠƒ(âŠš=0)Â¤-@0âŠœâˆ˜âŠ¸â‰ @\n
  A â† S!(â—´â‰¡â—‡âŠ£)
  B â† S!(âˆ˜)
â””â”€â•´

â”Œâ”€â•´Dâ‚â‚
  # count ? n rem
  Blink â† |2 memo(
    â£(â©(1â—Œ)âŠ™Â°0
    | â©(Blink1-1)Â°0
    | â©(/+â‰¡BlinkâŠ™-â‚[âŠƒ(âŒŠÃ·|â—¿)]â¿:10Ã·2)Â°0âŠ¸â—¿2âŠ¸(+1âŒŠâ‚™10)
    | BlinkâŠ“Ã—â‚‚â‚€â‚‚â‚„-â‚))
  S â† /+â‰¡BlinkâŠœâ‹•âŠ¸â‰ @\sâ–½âŠ¸â‰ @\n:
  A â† S 25
  B â† S 75
â””â”€â•´

â”Œâ”€â•´Dâ‚â‚‚
  P â† âŠœâ–¡âŠƒ(-@\0|â‡¡â–³)âŠœâˆ˜âŠ¸â‰ @\n
  A â† /+â‰¡â—‡(Ã—âŸœ(-:Ã—4)âŠƒ(â§»|/+â‰¡(=1/+âŒµ/-)â§…â‰ 2))P
  B â† /+â‰¡â—‡(
    Ã—â§»âŸœ(
      Â°âŠš
      /+[(âˆ©â‚„(/+â‰¡(â§»âŠœ0.)â‰=1â‰¡\(Ã—âŠ¸+))âŠƒ(âˆ˜|â‰|â‰¡â‡Œ|â‰¡â‡Œâ‰))]
    )
  )P
â””â”€â•´

â”Œâ”€â•´Dâ‚â‚ƒ
  P â† âŠœ(
    â–½âŠ¸â‰ @\n
    âˆ©â‚ƒâŠŸâˆ©â‚†â‹•Â°$"Button A: X+_, Y+_Button B: X+_, Y+_Prize: X=_, Y=_"
  )Â¬âŠ¸â¦·"\n\n"
  A â† /+â‰¡(
    âŠ™(-âŠ™(Â¤:)âŠ¸Ã—Â¤âŸœâŠ¸(â‡¡â†§100/â†¥âŒŠÃ·))
    â¬š0âŠ¢+Ã—3âŠ¢â‰âˆ©â–½â€™Ã—(âŠƒ(/â†§â‰=0â—¿|âŠ¸(/=â‰)Ã·))Â¤
  )P
  # aA + cB = e
  # bA + dB = f
  # A = (e - cB) / a = (f - dB) / b
  # be - bcB = af - adB
  # B = (ad - bc) / (af - be)
  B â† /+â™­â–½âŠ¸(/â†§â‰=âŠ¸âŒŠ)â‰¡(|3
    âŠ™âŠ™âŠ™âŠ™(âˆ©(+10000000000000))âˆ©â‚ƒÂ°âŠŸ
    â— (Ã·âˆ©-âˆ©â‚„Ã—âŠƒ(â‹…âŠ™âˆ˜|âŠ™â‹…â‹…âˆ˜|â‹…âŠ™â‹…â‹…âˆ˜|âŠ™â‹…â‹…â‹…â‹…âˆ˜))
    âŠŸâŠ¸(Ã—3Ã·âŠ™(-Ã—|:)âŠ™â‹…âŠ™â‹…âŠ™â‹…âˆ˜)
  )P
â””â”€â•´

â”Œâ”€â•´Dâ‚â‚„
  P â† âŠƒ(âŠœ(âˆ©âŠŸâˆ©â‚„â‹•Â°$"p=_,_ v=_,_")âŠ¸â‰ @\n|â¨¬(7_11|101_103)>1000â§»)
  A â† /Ã—âŠ•â§».âŠ›â–½âŠ¸(/â†§â‰ 0â‰)Â±-âŠƒ(Â¤âŒŠÃ·2|â—¿Â¤):â‰¡(+âŠ™Ã—â‚â‚€â‚€)P
  B â† â‹…â‹…â‹…âˆ˜â¢âŠ“(âŠ¸+|âŠ™+â‚)(<30/â†¥âŠœâ§».â—¡(Â°âŠšâ—¿Â¤:âŠ™â—Œ))âŠ™âŠ™âŠ™0P
â””â”€â•´

â”Œâ”€â•´Dâ‚â‚…
  Dirs â† [Â¯1_0 0_1 1_0 0_Â¯1]
  P â† âŠ“(
    âŠƒ(âŠ¢âŠš=@@|âŠ—:".O#"âœâ™­(âœâ–½âˆµâ‹…@.âŠ¸=@@))âŠœâˆ˜âŠ¸â‰ @\n
  | âŠ—:"^>v<"â–½âŠ¸â‰ @\n
  )Â°$"_\n\n_"
  Shove â† âœâ†™(âŸœ(âˆŠ:0)â¥(âœâŠâ‡ŒâŠ¸(âŠŸ0âŠ—0))âŠ¸(/â†§âˆŠ:0_1))âŠ¸(âŠ—2)
  Draw  â† &p/$"_\n_"âŠ:".O#@"âœâŠ¡â‹…3
  A â† (
    âˆ§(
      &pâŠ:"^>v<".
      :âŠ™(+Ã—)âŠƒ(
        â¨¬(â‰âœâŠ(âœ(â‡Œâ†™)Shove:)âŠ™:Â°âŠŸâŠ“â‡Œâ‰   # up
        | âœâŠ(âœ(â†˜)Shove:)âŠ™:âŠ™+â‚Â°âŠŸ     # right
        | â‰âœâŠ(âœ(â†˜)Shove:)âŠ™:âŠ™+â‚Â°âŠŸâŠ“â‡Œâ‰ # down
        | âœâŠ(âœ(â‡Œâ†™)Shove:)âŠ™:Â°âŠŸ       # left
        )
      | âŠ:Dirs âŠ™âˆ˜
      )
    )â¤™âŠ™âŠ™â—ŒP
    /++Ã—100Â°âŠŸâ‰âŠš=1â—Œ
  )
â””â”€â•´

â”Œâ”€â•´Dâ‚â‚†
  Path â† path(
    âˆ©â–½,âŠƒ(+1Ã—1000Â¬â‰¡â‰|âŠƒ(â‰ @#â‰¡âŠ¡â—Œ|â‰¡âŠŸ)âŸœ+âŠ™â‹…âŠ™Â¤)Dâ‚â‚…~DirsâŠƒâ†™â†˜1
  | =@EâŠ¡âŠ£
  )âŠ¸(âŠŸ0_1âŠ¢âŠš=@S)âŠœâˆ˜âŠ¸â‰ @\n
  A â† â—ŒPath
  B â† â§»â—´âŠ£â¤¸1/â—‡âŠ‚âŠ™â—ŒPath
â””â”€â•´

â”Œâ”€â•´Dâ‚â‚‡
  P     â† âŠ“(âŠœ(â‹•â†˜12)âŠ¸â‰ @\n|âŠœâ‹•âŠ¸â‰ @,â–½âŠ¸â‰ @\nâ†˜9)Â°$"_\n\n_"
  Combo â† â¨¬(0|1|2|3|âŠ¢,|âŠ¡1,|âŠ£,)
  # ip reg out ? ip prog reg out
  Step â† (
    âŠƒ(âˆ˜|+Ã—2â‰ 3âŠ¢|â‹…â‹…âˆ˜)â¤š(â†™2â†˜)
    # inst ip reg out
    Â°âŠŸ
    â¨¬(âœâŠ™â—Œ(âœâŠ¢(âŒŠÃ·â¿:2:):)Combo        # adv
    | âœâŠ™â—Œ(âœâŠ¡â‚(âœâˆ©â‹¯(â¬š0â‰ )):)          # bxl
    | âœâŠ™â—Œ(âœâŠ¡â‚â—Œ:â—¿8)Combo            # bst
    | â¨¬(+2â—Œ|âŠ™â—Œ)â—¡(Â±âŠ¢â‹…â‹…âˆ˜)            # jnz
    | âœâ—Œ(âœâŠ¡â‚(âœâˆ©â‹¯(â¬š0â‰ ))âŸœâŠ£)â—Œ         # bxc
    | âœâŠ™â‹…â—Œ(âŠ‚:â—¿8)Combo              # out
    | âœâŠ™â—Œ(âœâŠ¡â‚â—Œâ¤™(âŒŠÃ·âŠƒ(â¿:2|â‹…âŠ¢)))Combo # bdv
    | âœâŠ™â—Œ(âœâŠ£â—Œâ¤™(âŒŠÃ·âŠƒ(â¿:2|â‹…âŠ¢)))Combo  # cdv
    )
  )
  # reg out ? prog reg
  Exec â† â‹…â—Œâ¢(:âŠƒâ‹…âˆ˜Step)(>âŠ™â§»)0âŠ™âŠ™[]
  A    â† /$"_,_"â‹…âˆ˜Exec:P
  # res ? start target prog
  NextOctit â† â–½âŠ¸(=âŠ™(â‰¡(â‹…âŠ¢ExecâŠ™(âŠ‚:0_0))Â¤))âŠƒ(â‹…âŠ™âˆ˜|+â‡¡8Ã—8)
  B â† /â†§â‹…âŠ™â‹…â—Œâ¢(
    # Q [res] prog rev-s
    âŠƒ(âŠ¸=â—¡âŠƒ(â‹…â‹…â‹…â‹…â§»|â¨¬(1|â§»base8)âŠ¸Â±)Â°âŠ‚
      â¨¬(â—´âŠ‚:âŠƒ(â‹…â‹…âˆ˜|NextOctitâŠƒ(â‹…âˆ˜|âŠ¡âŠ™â‹…â‹…â‹…â‹…âˆ˜|â‹…â‹…â‹…â‹…âˆ˜)|â‹…â‹…â‹…âˆ˜)|âŠ™âŠ‚:â—Œ)
    | â‹…â‹…âŠ™âˆ˜)
  )(>0â§»
  )â—¡(âŠ™[]NextOctit0 âŠ¢:)âŠƒ(â†˜Â¯2|â‡Œ)â—ŒP
â””â”€â•´

â”Œâ”€â•´Dâ‚â‚ˆ
  A â† (
    0_0â¬š0â†™âŠŸ.âŠ™(Â°âŠšâ†™)â¨¬(7 12|71 1024)âŠ¸(>1000â§»)âŠœ(âŠœâ‹•âŠ¸â‰ @,)âŠ¸â‰ @\n
    â—Œpath(â‰¡âŠ¸1â–½â¤š(Â¬â‰¡â¬š1âŠ¡)âŠ™Â¤+Aâ‚‚Â¤|â‰âŠ™(-1â–³))
  )
  B â† (
    â¬š1â†™âŠŸ.âŠ™(Â¬Â°âŠšâŠ¸â†™â‚)â¨¬(7|71)âŠ¸(>1000â§»)âŠœ(âŠœâ‹•âŠ¸â‰ @,)âŠ¸â‰ @\n
    $"_,_"Â°âŠŸâ‹…âŠ¢â¢(âŠƒ(âœâŠ¡â‹…0âŠâ‚:|â‹…â†˜â‚))(
      # âˆŠ:1â‰¡â—‡(â†§âŠƒ(âˆŠ:0_0|âˆŠ))âŠƒ(âŠœâ–¡:Â°âŠ¡|-1Â¤â–³)
      â£(1â—ŒâŠ¢path(â–½â¤š(â‰¡â¬š0âŠ¡)âŠ™Â¤+Aâ‚‚Â¤|â‰âŠ™(-1â–³))0_0|0)
    )
  )
â””â”€â•´

â”Œâ”€â•´Dâ‚â‚‰
  P â† âŠ“(âŠœâ–¡Â¬âŠ¸â¦·", "|âŠœâ–¡âŠ¸â‰ @\n)Â°$"_\n\n_"
  # num ? pat list
  Fit! â† |2 memo(
    ^0/+â‰¡(
      â£(â©(1)â‹…â—ŒÂ°.
      | â©(â¨¬(â‹…â‹…0|Fit!(^0)):âŠ™â‰âŠƒâ†˜â†™)Â°1âŠ¸<â—¡âˆ©â§»
      | 0â‹…â‹…â—Œ
      )âˆ©Â°â–¡
    )Â¤âŠ™âŸœÂ¤)
  A â† /+â‰¡Fit!(>0):Â¤P
  B â† /+â‰¡Fit!(âˆ˜):Â¤P
â””â”€â•´

â”Œâ”€â•´Dâ‚‚â‚‚
  RngNext â† â¬š0(â‰ âŸœâ†»â‚‹â‚â‚â‰ âŸœâ†»â‚…â‰ âŸœâ†»â‚‹â‚†)
  A       â† /+âœ(â‰â‹¯)(â¥â‚‚â‚€â‚€â‚€RngNextâ¬š0â†™24)âŠœâ‹•âŠ¸â‰ @\n
  B â† (
    âŠœâ‹•âŠ¸â‰ @\n
    â—¿10â‡Œ[â¥â‚‚â‚€â‚€â‚€âŠ¸âœ(â‰â‹¯)(RngNextâ¬š0â†™24)]
    âˆ©â‰âŠƒ(â§ˆâ‚„(âŒbase19â‰+9)â§ˆ-|â†˜4)
    /â†¥âŠ•/+âŠ›âˆ©â–½,âˆ©â‚ƒâ™­âŸœâ‰¡â—°
  )
â””â”€â•´

â”Œâ”€â•´Dâ‚‚â‚ƒ
  A â† (
    âŠƒ(â‰¡(â¥â‡ŒâŠ¸(â‰ @tâŠ¢âŠ¢))â–½âŠ¸(âˆŠ:@tâ‰¡(âŠ¢â‰))
      âŠ•â–¡âŠ›â‰¡Â°âŠŸ
    | Â¤
    )âŠœ(â†âŠœâˆ˜âŠ¸â‰ @-)âŠ¸â‰ @\n
    /+â‰¡â—‡(/+âˆŠ:â‰¡â†â§…â‚‚<)
  )
  B â† (
    âŠƒ(â—´â™­|â‰¡â–¡|Â¤)â‰¡â†âŒbase26-@aâŠœ(âŠœâˆ˜âŠ¸â‰ @-)âŠ¸â‰ @\n
    âŠâŠ¸(âŠ¢â–âšâ§»)âŠ™â—Œâˆ§(
      â—´âŠ¸âš(â¨¬(â‹…âŠ™â—Œ|â¨¬(â—Œ|â†âŠ‚)âŠƒ(/â†§ğ„ˆâˆŠâ‰¡(â†âŠŸ)|âŠ™âˆ˜))â—¡(Â¬ğ„ˆâˆŠ))
    )
    /$"_,_"â†+@abase26Â°â–¡
  )
â””â”€â•´

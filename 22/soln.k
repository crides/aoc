s1a: {|/{$[y;x+y;0]}\.'x}
s1b: {s:{$[y;x+y;0]}\.'x;m:(*|s),{$[x;0;y]}':s;+/3#m@>m}

s2a: +/{(a;w;b):x;b-:"W";a-:"@";b+3 6 0@3!b-a}'
s2b: +/{(a;w;b):x;b-:"X";a-:"A";1+(3*b)+3!b+a-1}'

s1a: {|/{$[y;x+y;0]}\.'x}
s1b: {s:{$[y;x+y;0]}\.'x;m:(*|s),{$[x;0;y]}':s;+/3#m@>m}

s2a: +/{(a;w;b):x;b-:"W";a-:"@";b+3 6 0@3!b-a}'
s2b: +/{(a;w;b):x;b-:"X";a-:"A";1+(3*b)+3!b+a-1}'

p: +/{x-$[x>"a";"`";"&"]}' / priority sum
s3a: {p@{g:#'=,/?'(2,-2!#x)#x;*(!g)@&.g=2}'x}
s3b: {p@{g:#'=,/?'x;*(!g)@&.g=3}'((-3!#x),3)#x}
